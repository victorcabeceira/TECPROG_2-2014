\documentclass[a4paper,10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[brazil]{babel}
\usepackage{geometry}
\usepackage{fancyvrb} 
\usepackage{graphicx}
\usepackage{url}
\usepackage{subfigure}
\usepackage{eso-pic}

\DeclareGraphicsExtensions{.png,.jpg}

\newcommand\BackgroundPic{%
\put(0,0){%
\parbox[b][\paperheight]{\paperwidth}{%
\vfill
\centering
\includegraphics[width=\paperwidth,height=\paperheight,%
keepaspectratio = false]{background.jpg}%
\vfill
}}}

\newcommand\CoverPic{%
\put(0,0){%
\parbox[b][\paperheight]{\paperwidth}{%
\vfill
\centering
\includegraphics[width=\paperwidth,height=\paperheight,%
keepaspectratio = false]{book_cover.jpg}%
\vfill
}}}

\begin{document}

\include{cover}

\include{presentation}
%\AddToShipoutPicture*{\BackgroundPic}

%	\section{Objetivos}
%	
%		Desenvolver rotinas de inicialização e controle para os periféricos de uma placa-filha
%		com microprocessador da família ARM7, com o propósito de instrumentar eletrônicamente um
%		veículo aéreo não tripulado (VANT), dando base para o avanço do projeto mestre ``MINIVANT 
%		- Desenvolvimento de um Sistema de Mini-VANT para Imageamento Giro-Estabilizado'', desenvolvido
%		em parceria com o Prof. Geovany Araújo Borges do Laboratório de Automação e Robótica (LARA) 
%		da Faculdade de Tecnologia (FT), o Instituto Tecnológico  de Aeronáutica (ITA) e a empresa privada XMobots.
%	
%	\section{Introdução}
%	
%		VANTs possuem vasta aplicação, sendo utilizados usualmente em tarefas que seriam demasiadamente dispendiosas para serem realizadas por
%		uma aeronave de grande porte (obtenção de imagens georeferrenciadas \cite{medeiros-etal}, por exemplo) ou perigosas demais (espalhar 
%		agrotóxicos em uma plantação). VANTs equipados com câmeras também são utilizados para vigilância aérea, aplicação esta que faz com que 
%		VANTs sejam de especial interesse para fins militares.
%		
%%		\begin{figure}[htb]
%%		\centering
%%		\includegraphics[scale=0.5]{geo-ref.eps}
%%		\caption{Imagem georreferenciada obtida com VANT. \cite{medeiros-etal}}
%%		\end{figure}
%	
%		Nos últimos anos é possível observar um crescimento do desenvolvimento e aplicação de VANTs tanto fora quanto dentro
%		do Brasil\cite{forecast05}. Os esforços realizados dentro do Brasil são	principalmente por parte do Estado, mais 
%		especificamente	através das instituições militares, como por exemplo o VANT Carcarah, desenvolvido pela Marinha. Uma iniciativa brasileira 
%		que também merece destaque vem por parte do Instituto Nacional de Ciência e Tecnologia em Sistema Embarcados Críticos (INCT-SEC), que 
%		consiste em um quadrimotor utilizado para espalhar agrotóxicos de maneira a não agredir o meio ambiente \cite{costa-etal}.	
%	
%		Durante o período 2009--2010, foi desenvolvido o projeto de iniciação científica ``Identificação de Posição 
%		e Temperatura em Aeronave não Tripulada'' (referido agora como ''Identificação de Posição''), sob orientação do Prof. Dr. Marcelino Monteiro 
%		de Andrade. O projeto consistiu em desenvolver rotinas computacionais para um microcontrolador da família ARM, promovendo assim algumas 
%		funcionalidades de um VANT, e ao longo da execução deste projeto, foram desenvolvidas uma série de rotinas computacionais básicas, como por 
%		exemplo controle e monitoramento de interfaces básicas de E/S (Entrada/Saída) \emph{timers}, comunicação por porta serial e \emph{parsing} das 
%		mensagens enviadas por um GPS (\emph{Global Positioning System}).
%	
%		Em comparação a um aeromodelo tradicional, um VANT possui uma série de sistemas que o provém de funcionalidades extras (como por exemplo 
%		controle de estabilidade automático) ou melhores parâmetros de operação (maior autonomia de voo, por exemplo). Dessa maneira, o 
%		desenvolvimento de um VANT traz uma série de desafios de engenharia, provendo um amplo campo de estudo. 
%		 
%		Através desta e de outras iniciativas, iniciou-se a participação do Laboratório de Instrumentação e Processamento de Imagens e Sinais 
%		(LIPIS) no projeto MINIVANT, que tem como objetivo a produção de um veículo miniVANT com autonomia de 60 minutos, raio de operação de 
%		20km, sistema de controle embarcado, carga útil com câmera com zoom ajustável, giro-estabilizada e apontamento, monitoramento por estação 
%		base e capacidade de ser operado por apenas duas pessoas. O presente relatório trata do trabalho da equipe de Projeto Eletrônico do Veículo 
%		no que diz respeito ao desenvolvimento dos módulos de \emph{software} de maneira a prover suporte aos protocolos de comunicação necessários
%		para interfaceamento com o GPS (comunicação serial com protocolo RS-232) e com a IMU (\emph{Inertial Measurement Unit}) (comunicação através de 
%		protocolo I2C). Além do interfaceamento com sensores é necessário o desenvolvimento de módulos de E/S para facilitar os testes de bancada, a fim 
%		de reduzir os possíveis erros durante o teste em voo. Muitos dos módulos de E/S já se encontravam prontos ou bastante adiantados em seu 
%		desenvolvimento, porém durante os primeiros meses de trabalho buscou-se aprimorar esses módulos adicionando funcionalidades baseadas no uso de 
%		interrupções (as modificações serão explicadas mais a frente no texto).
%		
%		Ao longo do desenvolvimento deste trabalho, a equipe também trabalhou em sintonia com o grupo responsável
%		pela confecção da placa filha onde será gravada a versão final do código para poder ser embarcada na aeronave. Este trabalho foi 
%		desenvolvido também no laboratório LIPIS, pelo aluno de Engenharia Eletrônica Willian Vilarino sob orientação do Prof. Dr. Marcelino
%		Andrade. 	

%	\section{Revisão Bibliográfica}
%		No que tange as referências utilizadas no desenvolvimento do projeto buscou-se livros reconhecidos pela comunidade de desenvolvedores 
%		sendo que para desenvolvimento na plataforma ARM a principal fonte foi o livro \emph{ARM System Developer's Guide} \cite{sloss04} além de 
%		manuais e exemplos fornecidos pela própria empresa fabricante do microprocessador e informações obtidas em fóruns de desenvolvedores.
%		
%		Também buscou-se refêrencias sobre padrões de desenvolvimento de \emph{device drivers} \cite{corbet05} e também referências para utilização 
%		do ambiente Linux sendo esta última encontrada em diversos sites e fóruns dedicados da comunidade Linux. 

%	\section{Metodologia}

%		Ao final projeto de Identificação de Posição o grupo possuia capacidade de capturar dados de um GPS atráves do protocolo RS-232 e gravá-los em
%		memória volátil afim de posteriormente passar estes dados para um computador tornando possível sua análise posterior. Esta abordagem era falha 
%		no sentido de que qualquer problema na alimentação do sistema fazia com que os dados fossem perdidos. Além disto, duas atividades propostas no
%		plano inicial do projeto de Identificação de Posição não foram realizadas, sendo estas o desenvolvimento de um módulo de leitura de um sensor de
%		temperatura e o voo experimental. 

%		Desta forma, a premissa do projeto atual era de partir dos resultados do projeto anterior e aprimorar os mesmos, além de adicionar novas 
%		funcionalidades de maneira obter um sistema mais robusto e que ofereça maiores possibilidades de aplicação. As principais funcionalidades 
%		que necessitavam ser adicionadas eram:
%		
%		1 - Protocolo de Comunicação para captura de dados de uma Unidade Inercial. 

%		2 - Gravação dos dados obtidos dos sensores em memória não volátil.
%		
%		Como algumas das principais necessidades de um sistema como o VANT é o baixo consumo de potência e dimensões reduzidas, buscou-se Unidades 
%		Inerciais que atendessem a estas especificações, e eventualmente decidiu-se adotar o modelo Stick 9DOF, que	contem em seu \emph{design} um 
%		acelerômetro ADX345, um magnetômetro HMC5883L e um giroscópio ITG-3200. Estes dispositivos permitem estimar com precisão a orientação de um 
%		sistema que utiliza esta IMU.


%		Em relação à solução para identificação de posição da aeronave decidiu-se utilizar o mesmo modelo de GPS utilizado no tranbalho desenvolvido
%		anteriormente, sendo este o GT320R, que se comunica através do protocolo RS-232 e envia mensagens no formato NMEA-0183.
%	

%		Durante a fase de desenvolvimento e testes do sistema foi utilizada uma placa de desenvolvimento McBoard com LPC2138, um microcontrolador de
%		arquitetura ARM7, fabricado pela empresa NXP Semiconductors.


%		Uma das dificuldades encontradas pela equipe consistia no fato de que o GPS escolhido enviava constantemente um caractere que fazia parte de uma 
%		mensagem maior e continha informações de telemetria obtidas pelo GPS, não sendo possível requisitar dados específicos de acordo com o necessário, 
%		sendo necessário aguardar uma mensagem completa, realizar o \emph{parse} desta mensagem, e então extrair os campos desejados (se houver algum).
%		A IMU comunica-se através de protocolo I2C, sendo possível requisitar manualmente uma leitura deste sensor. 

%		Além de tudo, era necessário ``casar'' de alguma maneira as informações obtidas de ambos os dispositivos, decidindo-se por fim utilizar o tempo 
%		registrado pelo GPS para marcar cada leitura de dados completa, que contém dados de latitude, longitude e medidas obtidas com a IMU. Como o GPS
%		utilizado possui uma frequência de 1Hz (isto é, manda um conjunto de mensagens completas em 1 segundo), o sistema acaba ficando preso a uma taxa 
%		de atualização também de 1Hz, sendo que tal taxa não é ótima para um sistema tão dinâmico quando um VANT. O sistema é mostrado de maneira mais
%		clara na figura ~\ref{sistema}.


%		Um dos primeiros passos para a implementação da solução consistiu em desenvolver um módulo que permitisse que o sistema funcionasse com interrupções.
%		Este diferencial permite a utilização de vários protocolos de comunicação em simultâneo, diminuindo problemas com relação ao fato de dedicar tempo de
%		processamento em excesso para algums dos protocolos, como acontecia no sistema desenvolvido no trabalho de Identificação de Posição, onde o protocolo
%		RS-232 utilizava o processador durante todo o tempo, sendo necessário realizar até mesmo o \emph{parse} após descarregar os dados obtidos em um 
%		computador.

%		Como mostrado na figura ~\ref{sistema}, o processador aguarda o recebimento de um dado do GPS para iniciar o fluxo principal, ficando ocioso caso 
%		contrário. Isso se dá atráves de um laço infinito na rotina principal, mas como mencionado anteriormente, devido ao fato de o sistema ser orientado
%		a interrupções é razoávelmente fácil adicionar neste laço alguma funcionalidade desejada, que será executada quando sistema não estiver ocupado atendendo 
%		a um pedido de interrupção.

%		Como dito anteriormente, as mensagens vem no padrão NMEA-0183, que consiste em mensagens iniciadas com o símbolo \$, seguidas por cinco caracteres que
%		identificam qual dispositivo enviou a mensagem, e os campos contendo os dados relativos àquela mensagem, após os campos da mensagem vem um asterisco, 
%		seguido do \emph{checksum} da mensagem.

%		Uma mensagem é considerada válida através de dois critérios:

%		1 - A mensagem é do tipo adequado;

%		2 - A mensagem não está corrompida;

%		O primeiro critério é avaliado atráves do tipo da mensagem recebida e o segundo baseia-se no checksum informado na própria mensagem e o calculado.
%		Os tipos de mensagem válidos são GPRMC, GPGGA e GPGLL, estes tipos de mensagem contém todos os campos necessários em uma única mensagem (latitude, 
%		longitude e tempo)\cite{nmea}.

%		Caso a mensagem passe nesses dois critérios, o sistema requista leituras de cada um dos nove sensores da IMU (3 para cada um dos dispositivos). Estas
%		informações são gravadas juntamente com os dados obtidos do GPS na memória \emph{Flash} do processador, tornando possível assim resgatar estes dados
%		mesmo em caso de problemas na alimentação, o que não acontecia no sistema desenvolvido na projeto de Identificação de Posição, já que este utilizava
%		apenas a memória RAM do processador para armazenar os dados obtidos dos sensores.

%		As rotinas computacionais mencionadas acima foram desenvolvidas e testadas no placa McBoard (Figura ~\ref{mcboard}) (que possui um processador LPC2138) sendo posteriormente 			adaptadas para funcionar com a placa filha desenvolvida pelo aluno Willian Vilarino (Figura ~\ref{placafilha}, que possui um processador LPC2148).


%		Em  julho de 2012, utilizando a placa McBoard com uma das versões do código desenvolvido e realizando um percurso de carro na cidade do Gama, 
%		foram obtidas medidas relativas à posição e dados inerciais do automóvel, realizando assim a etapa de validação em bancada do sistema.

%		Um voo experimental foi realizado no dia 25/08/2012, onde foram coletados dados para avaliar a validade da solução. Estes dados serão discutidos mais adiante
%		no relatório. A figura a seguir mostra a aeronave em que a placa foi acoplada para testes.


%	\section{Equipe Técnica}
%		A equipe do projeto consiste do aluno de Engenharia Eletrônica Guilherme de Oliveira Costa, orientado pelo Prof. Dr. Edson Alves da Costa Júnior. Esta equipe
%		trabalho em conjunto com a equipe do Laboratório LCMA (Laboratório de Computação Musical e Áudio) para desenvolvimento de funções dos módulos básicos do 
%		microcontrolador e também com a equipe formada pelo aluno Willian Vilarino Leite e pelo Prof. Dr. Marcelino Monteiro de Andrade, que desenvolveram um projeto de 
%		placa filha que será utilizada como alvo final das rotinas computacionais desenvolvidas neste trabalho.

%	\section{Resultados}
%		As medidas obtidas no teste de bancada foram colocadas em um arquivo texto utilizado como entrada em um programa desenvolvido pelos alunos Lucas Severo
%		e Pablo Alejandro (também integrantes do LIPIS) que gera um arquivo .kml, um formato próprio para exibir traçados de rotas, figuras geométricas, etc. no
%		\emph{software} Google Earth baseado em uma linguagem de marcação (neste caso o KML ou \emph{Keyhole Markup Language}). A figura ~\ref{gearth} mostra
%		o traçado da rota realizada (a altura foi exagerada para facilitar a visualização, e não corresponde a uma medida real).


%		Também foi desenvolvido uma rotina em MATLAB pelo professor Marcelino Monteiro de Andrade, onde é utilizado filtro de Kalman para realizar estimativas
%		e minimizar os erros encontrados em dispositivos de medição inercial. O vídeo pode ser assistido em \cite{video_imu}.

%		Os dados coletados no voo experimental também foram utilizados para gerar uma rota no Google Earth (Figura 9a), que é mostrada ao lado de uma
%		figura gerada com dados obtidos com um software comercial de telemetria (Figura9b) também embarcado na aeronave	utilizada nos testes  (mas não no mesmo microcontrolador).


%	\section{Conclusões}
%		O uso da memória \emph{Flash} traz problemas relativos à temporização das tarefas que devem ser realizadas pelo processador. Como o sistema é
%		cadenciado pelo GPS,  e como o mesmo não suporta requisições de informações específicas, é necessário que a latência do sistema seja mínima porém com a introdução
%		do uso da memória Flash é adicionado um atraso de 1 milissegundo por gravação. Além disso existe o atraso devido ao processo de \emph{parsing} da mensagem
%		capturada, o que ocorre sempre que uma mensagem completa e recebida. O grupo teorizou que devido a esses atrasos o sistema pode perder sincronismo, e entrar
%		em um ``\emph{loop} de mensagens ruins'', isto é, capturar apenas mensagens que não atendem aos critérios estabelecidos e perdendo as mensagens válidas o que
%		leva a períodos no qual o sistema não grava nenhum dado.

%		Como é possível ver na comparação entre os dados capturados com o \emph{software} desenvolvido e o comercial, o primeiro possui falha em parte do percurso,
%		assim como saltos repentinos em outros pontos. Ao analisar os dados no arquivo de captura, é possível ver que houve repetição de dados durante parte do percurso,
%		assim como dados nulos no início, o que se deve a falha do GPS, que perdeu os satélites em seu alcance, mantendo a ultima leitura válida (no caso dos daods repetidos),
%		ou enviando dados nulos (o que acontece no início do voo, pois não haviam dados anteriores válidos). Dessa maneira verificou-se que apenas 1/3 dos dados obtidos durante
%		o voo eram aproveitáveis, enquanto nos testes de bancada todas as mensagens gravadas eram válidas.

%		Durante a realização dos testes percebeu-se também o quanto o sistema é influenciado por vibrações mecânicas, especialmente no que diz respeito às
%		mensagens obtidas do GPS, que são transmitidas através de conexão serial, sendo que o GPS é ligado ao sistema através de um conector DB-9. Em caso até
%		mesmo de vibrações leves, o sistema entra em um \emph{loop} de mensagens ruins, prejudicando a fidelidade dos dados obtidos. Esse problema pode ser reduzido
%		fabricando uma cama especial para o \emph{hardware}, o que pode ser realizado utilizando o a impressora 3D desenvolvida no Laboratório de Engenharia e Inovação
%		(LEI), a LEIzinha \cite{leizinha}.

%	\section{Agradecimentos}
%		Este trabalho foi apoiado pelos laboratório LIPIS e LCMA da UnB Gama, agradecendo em especial aos alunos Heitor Moraes Couto 
%		e Thales da Cruz Portela que auxiliaram no desenvolvimento dos módulos básicos do microcontrolador, ao aluno Willian Vilarino Leite e ao professor Marcelino 
%		Monteiro de Andrade que projetaram e fabricaram a placa filha utilizada nos experimentos, assim como ao professor Fábio Macêdo Mendes responsável pela construção,
%		manutenção e pilotagem da aeronave desenvolvida no laboratório e também ao técnico Yuri Dias, que construiu e pilotou a aeronave utilizada no voo experimental.

%\bibliographystyle{ieeetr}
%\bibliography{refs}

\end{document}
